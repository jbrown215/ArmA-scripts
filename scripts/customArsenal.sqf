_target = _this select 0;

_rifleman = [["rhs_weap_m4","","rhsusf_acc_anpeq15_wmx","rhsusf_acc_ACOG_RMR",["rhs_mag_30Rnd_556x45_M855A1_Stanag",30],[],"rhsusf_acc_grip1"],["rhs_weap_M136","","","",[],[],""],[],["rhs_uniform_g3_mc",[["ACRE_PRC343",1],["ACE_elasticBandage",5],["ACE_quikclot",5],["ACE_packingBandage",5],["ACE_EarPlugs",1],["ACE_Flashlight_MX991",1],["ACE_IR_Strobe_Item",1],["ACE_morphine",2],["ACE_splint",4],["KNB_Notebook",1]]],["milgp_v_jpc_assaulter_mc",[["ACE_tourniquet",4],["ACE_wirecutter",1],["rhs_mag_30Rnd_556x45_M855A1_Stanag",7,30],["ACE_M84",2,1],["rhs_mag_m67",2,1],["rhs_mag_an_m8hc",2,1]]],["rhsusf_assault_eagleaiii_ocp",[["ACE_EntrenchingTool",1],["ACE_morphine",5],["ACE_bodyBag",1],["ACE_CableTie",4],["rhs_mag_30Rnd_556x45_M855A1_Stanag_Tracer_Red",5,30]]],"rhsusf_ach_helmet_ocp","",[],["ItemMap","ItemAndroid","","ItemCompass","ItemWatch",""]];

_riflemanCLS = [["rhs_weap_m4","","rhsusf_acc_anpeq15_wmx","rhsusf_acc_ACOG_RMR",["rhs_mag_30Rnd_556x45_M855A1_Stanag",30],[],"rhsusf_acc_grip1"],[],[],["rhs_uniform_g3_mc",[["KNB_Notebook",1],["ACE_splint",4],["ACE_IR_Strobe_Item",1],["ACE_Flashlight_MX991",1],["ACE_EarPlugs",1],["ACE_CableTie",5],["ACE_morphine",5],["ACRE_PRC343",1]]],["milgp_v_jpc_assaulter_mc",[["rhs_mag_30Rnd_556x45_M855A1_Stanag",7,30],["ACE_M84",2,1],["rhs_mag_m67",2,1],["rhs_mag_an_m8hc",2,1]]],["rhsusf_assault_eagleaiii_ocp",[["ACE_bodyBag",1],["ACE_morphine",10],["ACE_elasticBandage",15],["ACE_packingBandage",15],["ACE_quikclot",15],["ACE_salineIV_500",5],["ACE_splint",10],["ACE_tourniquet",5],["rhs_mag_30Rnd_556x45_M855A1_Stanag_Tracer_Red",5,30]]],"rhsusf_ach_helmet_ocp","",[],["ItemMap","ItemAndroid","","ItemCompass","ItemWatch",""]];

_grenadier = [["rhs_weap_m4_m320","","rhsusf_acc_anpeq15_wmx","rhsusf_acc_ACOG_RMR",[],[],""],[],[],["rhs_uniform_g3_mc",[["ACRE_PRC343",1],["ACE_EarPlugs",1],["ACE_Flashlight_MX991",1],["ACE_IR_Strobe_Item",1],["KNB_Notebook",1],["ACE_CableTie",4],["ACE_quikclot",5],["ACE_packingBandage",5],["ACE_elasticBandage",5],["ACE_splint",3]]],["milgp_v_marciras_grenadier_mc",[["ACE_splint",1],["ACE_tourniquet",5],["rhs_mag_m67",4,1],["ACE_M84",2,1],["rhs_mag_30Rnd_556x45_M855A1_Stanag",7,30],["1Rnd_HE_Grenade_shell",6,1]]],["rhsusf_assault_eagleaiii_ocp",[["ACE_bodyBag",1],["ACE_EntrenchingTool",1],["rhs_mag_30Rnd_556x45_M855A1_Stanag_Tracer_Red",5,30],["rhs_mag_m713_Red",2,1],["rhs_mag_m714_White",4,1],["ACE_40mm_Flare_red",1,1],["ACE_40mm_Flare_green",1,1],["UGL_FlareCIR_F",1,1],["1Rnd_HE_Grenade_shell",6,1]]],"rhsusf_ach_helmet_ocp","",[],["ItemMap","ItemAndroid","","ItemCompass","ItemWatch",""]];

_team_squad_leader = [["rhs_weap_m4","","rhsusf_acc_anpeq15_wmx","rhsusf_acc_ACOG_RMR",["rhs_mag_30Rnd_556x45_M855A1_Stanag",30],[],"rhsusf_acc_grip1"],[],["rhsusf_weap_m9","","","",["rhsusf_mag_15Rnd_9x19_JHP",15],[],""],["rhs_uniform_g3_mc",[["ACRE_PRC343",1],["ACE_EarPlugs",1],["ACE_CableTie",4],["ACE_Flashlight_MX991",1],["ACE_IR_Strobe_Item",1],["KNB_Notebook",1],["ACE_RangeCard",1],["ACE_splint",4],["ACE_elasticBandage",5],["ACE_packingBandage",5],["ACE_quikclot",2]]],["milgp_v_marciras_teamleader_belt_mc",[["ACE_tourniquet",5],["ACE_splint",2],["ACRE_PRC152",1],["rhs_mag_30Rnd_556x45_M855A1_Stanag",7,30],["rhs_mag_m67",2,1],["SmokeShellBlue",2,1],["rhs_mag_an_m8hc",4,1]]],["rhsusf_assault_eagleaiii_ocp",[["ACE_bodyBag",1],["ACE_EntrenchingTool",1],["ACE_SpraypaintBlue",1],["ACE_Clacker",1],["rhs_mag_30Rnd_556x45_M855A1_Stanag_Tracer_Red",5,30],["AMP_Breaching_Charge_Mag",2,1],["rhsusf_m112_mag",1,1]]],"rhsusf_ach_helmet_ocp","",[],["ItemMap","ItemAndroid","","ItemCompass","ItemWatch",""]];

_medic = [["rhs_weap_m4","","rhsusf_acc_anpeq15_wmx","rhsusf_acc_ACOG_RMR",["rhs_mag_30Rnd_556x45_M855A1_Stanag",30],[],"rhsusf_acc_grip1"],[],["rhsusf_weap_m9","","","",["rhsusf_mag_15Rnd_9x19_JHP",15],[],""],["rhs_uniform_g3_mc",[["ACRE_PRC343",1],["ACE_EarPlugs",1],["ACE_Flashlight_MX991",1],["ACE_IR_Strobe_Item",1],["KNB_Notebook",1],["ACE_splint",4],["ACE_packingBandage",5],["ACE_quikclot",5],["ACE_elasticBandage",5],["ACE_CableTie",2]]],["milgp_v_jpc_medic_belt_mc",[["ACE_EntrenchingTool",1],["rhs_mag_an_m8hc",4,1],["SmokeShellBlue",4,1],["B_IR_Grenade",2,1],["rhs_mag_30Rnd_556x45_M855A1_Stanag",7,30]]],["B_Carryall_cbr",[["ACE_elasticBandage",20],["ACE_adenosine",20],["ACE_packingBandage",20],["ACE_quikclot",10],["ACE_bodyBag",2],["ACE_epinephrine",20],["ACE_morphine",20],["ACE_salineIV",10],["ACE_salineIV_250",5],["ACE_salineIV_500",5],["ACE_splint",10],["ACE_surgicalKit",1],["ACE_tourniquet",10]]],"rhsusf_ach_helmet_ocp","",[],["ItemMap","ItemAndroid","","ItemCompass","ItemWatch",""]];

_autorifleman = [["rhs_weap_m249_pip_S_para","","","rhsusf_acc_ELCAN",[],[],"rhsusf_acc_saw_lw_bipod"],[],[],["rhs_uniform_g3_mc",[["ACE_elasticBandage",5],["ACE_packingBandage",5],["ACE_quikclot",5],["ACE_CableTie",4],["ACE_EarPlugs",1],["ACE_IR_Strobe_Item",1],["ACE_Flashlight_MX991",1],["KNB_Notebook",1],["ACE_RangeCard",1],["ACE_splint",4],["ACE_tourniquet",4]]],["milgp_v_mmac_hgunner_MC",[["ACE_EntrenchingTool",1],["ACE_bodyBag",1],["ACE_IR_Strobe_Item",1],["rhs_mag_an_m8hc",2,1],["rhsusf_200Rnd_556x45_M855_mixed_soft_pouch",2,200]]],["B_Carryall_khk",[["rhsusf_200Rnd_556x45_M855_mixed_soft_pouch",4,200]]],"rhsusf_ach_helmet_ocp","",[],["ItemMap","ItemAndroid","","ItemCompass","ItemWatch",""]];

_uhPilot = [["rhs_weap_m4","","rhsusf_acc_anpeq15","rhsusf_acc_compm4",[],[],"rhsusf_acc_grip1"],[],["rhsusf_weap_m9","","","",["rhsusf_mag_15Rnd_9x19_JHP",15],[],""],["rhs_uniform_cu_ocp_1stcav",[["ACE_Flashlight_XL50",1],["ACE_microDAGR",1],["KNB_Notebook",1],["ACE_fieldDressing",5],["ACE_elasticBandage",5],["ACE_packingBandage",5],["ACE_bodyBag",1],["ACE_quikclot",5],["ACE_EarPlugs",1],["KNB_PanelYellow",1],["ACE_tourniquet",4],["ACE_IR_Strobe_Item",1]]],["rhsusf_spcs_ocp_crewman",[["rhsusf_mag_15Rnd_9x19_FMJ",3,15],["rhs_mag_30Rnd_556x45_M855A1_Stanag",7,30],["ACE_M14",1,1],["rhs_mag_an_m8hc",2,1],["ACE_Chemlight_IR",2,1],["B_IR_Grenade",2,1],["Chemlight_green",2,1],["ACE_HandFlare_Green",1,1],["SmokeShellBlue",1,1]]],["rhsusf_assault_eagleaiii_ocp",[["ACRE_PRC117F",1],["ACE_EntrenchingTool",1],["ACE_IR_Strobe_Item",1],["SmokeShellBlue",1,1],["ACE_HandFlare_Green",1,1],["ACE_Chemlight_IR",1,1],["Chemlight_green",1,1]]],"rhsusf_hgu56p_tan","",["Rangefinder","","","",[],[],""],["ItemMap","","ItemRadioAcreFlagged","ItemCompass","ItemWatch",""]];

_droneop = [[],[],[],["tft8_soac_uniform",[["rhsusf_ANPVS_14",1],["rhsusf_patrolcap_ocp",1],["ACE_EarPlugs",1],["ACE_Flashlight_XL50",1],["ACRE_PRC343_ID_1",1],["ACE_fieldDressing",1],["ACE_packingBandage",1],["ACE_morphine",1],["ACE_tourniquet",1],["ItemAndroid",1]]],[],["rhsusf_assault_eagleaiii_ocp",[["ACE_EarPlugs",1],["ACRE_PRC117F_ID_1",1],["ACRE_PRC152_ID_1",1]]],"tft8_patrolcap_field","",[],["ItemMap","B_UavTerminal","ItemRadioAcreFlagged","ItemCompass","ItemWatch",""]];
_loadoutMapping = [
  ["Rifleman", _rifleman, []],
  ["Rifleman CLS", _riflemanCLS, []],
  ["Grenadier", _grenadier, []],
  ["Team/Squad Leader", _team_squad_leader, []],
  ["Medic", _medic, ["Section Leader@Medic Section", "Assistant Section Leader@Medic Section", "Team Leader@Medic Section", "Medic@Medic Section", "Company 1SG@Alpha Company HQ", "Company XO@Alpha Company HQ", "Company Commander@Alpha Company HQ"]],
  ["Autorifleman", _autorifleman, []],
  ["UH60 Pilot", _uhPilot, ["Assistant Detachment Commander@USASOC-UFC", "Detachment Commander@USASOC-UFC", "UH-60 Pilot@USASOC-UFC"]],
  ["Drone Operator", _droneop, ["Assistant Detachment Commander@USASOC-UFC", "Detachment Commander@USASOC-UFC", "MQ-9 Operator@USASOC-UFC"]]
];

{
  _currWhitelist = (_x select 2);
  _currLoadout = (_x select 1);
  _currRole = (_x select 0);
  
  _target addAction [format ["Equip %1 Loadout", _currRole], {
    _caller = (_this select 1);
    _currRole = (_this select 3) select 0;
    _currLoadout = (_this select 3) select 1;    

    _caller setUnitLoadout (_currLoadout);
    [format ["Selected %1 Loadout", _currRole], "hint", _caller, true] call BIS_fnc_MP;

    _caller playMove "AmovPercMstpSrasWrflDnon_AmovPercMstpSnonWnonDnon";
    _caller action ["SWITCHWEAPON", _caller, _caller,-1];

    // For later use in customization options, we should have the player carry around their role name
    _caller setVariable ["role", _currRole];
  }, [_currRole, _currLoadout], 10, true, true, "",
  format ["_whitelist = %1;
   _unitRole = roleDescription _this;
   _inWhitelist = _whitelist findIf {_x == _unitRole} > -1;
   _whitelist isEqualTo [] || _inWhitelist;
  ", _currWhitelist], 
   4.5, false, "", ""];
} forEach _loadoutMapping;
